---
ANSIBLE_METADATA: |
    {
      'metadata_version': '1.1',
      'status': ['preview'],
      'supported_by': 'network'
    }

DOCUMENTATION: |
  module: ios_acls
  version_added: 2.10
  short_description: Configure and manage Named or Numbered ACLs on IOS devices.
  description: This module configures and manages the Named or Numbered on IOS platforms.
  author: Sumit Jaiswal (@justjais)
  notes:
  - Tested against Cisco IOSv Version 15.2 on VIRL
  - This module works with connection C(network_cli).
    See L(IOS Platform Options,../network/user_guide/platform_ios.html).
  options:
    config:
      description: A dictionary of ACL options
      type: list
      elements: dict
      suboptions:
        name:
          description: The name of the ACL
          type: str
          suboptions:
            standard:
              description: Standard Access List
              type: bool
            extended:
              description: Extended Access List
              type: bool
            resequence:
              description: Resequence Access List
              suboptions:
                start_sequence:
                  description:
                  - Starting Sequence Number.
                  - Refer to vendor documentation for valid values.
                  type: int
                increment_sequence:
                  description:
                  - Step to increment the sequence number.
                  - Refer to vendor documentation for valid values.
                  type: int
        number:
          description:
          - IP ACLs number.
          - Refer to vendor documentation for valid values.
          type: int
        entries:
          description: The entries within the ACL
          mutually_exclusive: [[name], [number]]
          elements: dict
          required_together: [[action, protocol, source, destination]]
          type: list
          suboptions:
            action:
              description: Specify the action
              type: str
              choice: ['permit', 'deny']
            source:
              description: Specify the packet source
              type: dict
              required_together: [[address, wildcard_bits]]
              suboptions:
                address:
                  description: Source network address
                  type: str
                wildcard_bits:
                  description: Destination wildcard bits
                  type: str
            destination:
              description: Specify the packet destination
              required_together: [[address, wildcard_bits]]
              type: dict
              suboptions
                address:
                  description: Host address to match, or any single host address
                  type: str
                wildcard_bits:
                    description: Destination wildcard bits
                    type: str
                operators:
                  description: Specify the destination operator based on port number
                  type: dict
                  suboptions:
                    eq:
                      description: Match only packets on a given port number
                      type: str
                    gt:
                      description: Match only packets with a greater port number
                      type: str
                    lt:
                      description: Match only packets with a lower port number
                      type: str
                    neq:
                      description: Match only packets not on a given port number
                      type: str
                    range:
                      description: Port group
                      type: dict
                      suboptions:
                        start:
                          description: Specify the start of the port range
                          type: int
                        end:
                          description: Specify the end of the port range
                          type: int
                dscp:
                  description: Destination wildcard bits
                  type: str
                log:
                  description: Log matches against access-list entry
                  type: str
                log-input:
                  description: Log matches against this entry, including input interface
                  type: str
                option:
                  description: Match packets with given IP Options value
                  type: dict
                  suboptions:
                    add-ext
                      description: Match packets with Address Extension Option (147)
                      type: bool
                    any-options:
                      description: Match packets with ANY Option
                      type: bool
                    com-security:
                      description: Match packets with Commercial Security Option (134)
                      type: bool
                    dps:
                      description: Match packets with Dynamic Packet State Option (151)
                      type: bool
                    encode:
                      description: Match packets with Encode Option (15)
                      type: bool
                    eool:
                      description: Match packets with End of Options (0)
                      type: bool
                    ext-ip:
                      description: Match packets with Extended IP Option (145)
                      type: bool
                    ext-security:
                      description: Match packets with Extended Security Option (133)
                      type: bool
                    finn:
                      description: Match packets with Experimental Flow Control Option (205)
                      type: bool
                    imitd:
                      description: Match packets with IMI Traffic Desriptor Option (144)
                      type: bool
                    lsr:
                      description: Match packets with Loose Source Route Option (131)
                      type: bool
                    mtup:
                      description: Match packets with MTU Probe Option (11)
                      type: bool
                    mtur:
                      description: Match packets with MTU Reply Option (12)
                      type: bool
                    no-op:
                      description: Match packets with No Operation Option (1)
                      type: bool
                    nsapa:
                      description: Match packets with NSAP Addresses Option (150)
                      type: bool
                    record-route:
                      description: Match packets with Record Route Option (7)
                      type: bool
                    router-alert:
                      description: Match packets with Router Alert Option (148)
                      type: bool
                    sdb:
                      description: Match packets with Selective Directed Broadcast Option (149)
                      type: bool
                    security:
                      description: Match packets with Basic Security Option (130)
                      type: bool
                    ssr:
                      description: Match packets with Strict Source Routing Option (137)
                      type: bool
                    stream-id:
                      description: Match packets with Stream ID Option (136)
                      type: bool
                    timestamp:
                      description: Match packets with Time Stamp Option (68)
                      type: bool
                    traceroute:
                      description: Match packets with Trace Route Option (82)
                      type: bool
                    ump:
                      description: Match packets with Upstream Multicast Packet Option (152)
                      type: bool
                    visa:
                      description: Match packets with Experimental Access Control Option (142)
                      type: bool
                    zsu:
                      description: Match packets with Experimental Measurement Option (10)
                      type: bool
                precedence:
                  description: Match packets with given precedence value
                  type: int
                time-range:
                  description: Specify a time-range
                  type: str
                tos:
                  description: Match packets with given TOS value
                  type: dict
                  suboptions:
                    max-reliability
                      description: Match packets with max reliable TOS (2)
                      type: bool
                    max-throughput:
                      description: Match packets with max throughput TOS (4)
                      type: bool
                    min-delay :
                      description: Match packets with min delay TOS (8)
                      type: bool
                    min-monetary-cost:
                      description: Match packets with min monetary cost TOS (1)
                      type: bool
                    normal:
                      description: Match packets with normal TOS (0)
                      type: bool
                  ttl:
                    description: Match packets with given TTL value
                    type: dict
                    suboptions:
                      eq:
                        description: Match only packets on a given TTL number
                        type: int
                      gt:
                        description: Match only packets with a greater TTL number
                        type: int
                      lt:
                        description: Match only packets with a lower TTL number
                        type: int
                      neq:
                        description: Match only packets not on a given TTL number
                        type: int
                      range:
                        description: Match only packets in the range of TTLs
                        type: dict
                        suboptions:
                          start:
                            description: Specify the start of the port range
                            type: int
                          end:
                            description: Specify the end of the port range
                            type: int
            match_categories:
              description: protocol type
              type: dict
              suboptions:
                ahp:
                  description: Authentication Header Protocol
                  type: bool
                eigrp:
                  description: Cisco's EIGRP routing protocol
                  type: bool
                esp:
                  description: Encapsulation Security Payload
                  type: bool
                gre:
                  description: Cisco's GRE tunneling
                  type: bool
                icmp:
                  description: Internet Control Message Protocol
                  type: dict
                  suboptions:
                    administratively-prohibited:
                      description: Administratively prohibited
                      type: bool
                    alternate-address
                      description: Alternate address
                      type: bool
                    conversion-error:
                      description: Alternate address
                      type: bool
                    dod-host-prohibited:
                      description: Host prohibited
                      type: bool
                    dod-net-prohibited:
                      description: Net prohibited
                      type: bool
                    dscp:
                      description: Match packets with given dscp value
                      type: bool
                    echo:
                      description: Echo (ping)
                      type: bool
                    echo-reply:
                      description: Echo reply
                      type: bool
                    fragments:
                      description: Check non-initial fragments
                      type: bool
                    general-parameter-problem:
                      description: Parameter problem
                      type: bool
                    fragments:
                      description: Check non-initial fragments
                      type: bool
                    host-isolated:
                      description: Host isolated
                      type: bool
                    host-precedence-unreachable:
                      description: Host unreachable for precedence
                      type: bool
                    host-redirect:
                      description: Host redirect
                      type: bool
                    host-tos-redirect:
                      description: Host redirect for TOS
                      type: bool
                    host-tos-unreachable:
                      description: Host unreachable for TOS
                      type: bool
                    host-unknown:
                      description: Host unknown
                      type: bool
                    host-unreachable:
                      description: Host unreachable
                      type: bool
                    information-reply:
                      description: Information replies
                      type: bool
                    information-request:
                      description: Information requests
                      type: bool
                    mask-reply:
                      description: Mask replies
                      type: bool
                    mask-request:
                      description: Mask requests
                      type: bool
                    mobile-redirect:
                      description: Mobile host redirect
                      type: bool
                    net-redirect:
                      description: Network redirect
                      type: bool
                    net-tos-redirect:
                      description: Net redirect for TOS
                      type: bool
                    net-tos-unreachable:
                      description: Network unreachable for TOS
                      type: bool
                    net-unreachable:
                      description: Net unreachable
                      type: bool
                    network-unknown:
                      description: Network unknown
                      type: bool
                    no-room-for-option:
                      description: Parameter required but no room
                      type: bool
                    packet-too-big:
                      description: Fragmentation needed and DF set
                      type: bool
                    parameter-problem:
                      description: All parameter problems
                      type: bool
                    port-unreachable:
                      description: Port unreachable
                      type: bool
                    precedence-unreachable:
                      description: Precedence cutoff
                      type: bool
                    protocol-unreachable:
                      description: Protocol unreachable
                      type: bool
                    reassembly-timeout:
                      description: Reassembly timeout
                      type: bool
                    redirect:
                      description: All redirects
                      type: bool
                    router-advertisement:
                      description: Router discovery advertisements
                      type: bool
                    router-solicitation:
                      description: Router discovery solicitations
                      type: bool
                    source-quench:
                      description: Source quenches
                      type: bool
                    source-route-failed:
                      description: Source route failed
                      type: bool
                    time-exceeded:
                      description: All time exceededs
                      type: bool
                    timestamp-reply:
                      description: Timestamp replies
                      type: bool
                    timestamp-request:
                      description: Timestamp requests
                      type: bool
                    traceroute:
                      description: Traceroute
                      type: bool
                    ttl-exceeded:
                      description: TTL exceeded
                      type: bool
                    unreachable:
                      description: All unreachables
                      type: bool
                igmp:
                  description: Internet Gateway Message Protocol
                  type: dict
                  suboptions:
                    dvmrp:
                      description: Distance Vector Multicast Routing Protocol(2)
                      type: bool
                    fragments:
                      description: Check non-initial fragments
                      type: bool
                    host-query:
                      description: IGMP Membership Query(0)
                      type: bool
                    mtrace-resp:
                      description: Multicast Traceroute Response(7)
                      type: bool
                    mtrace-route:
                      description: Multicast Traceroute(8)
                      type: bool
                    pim:
                      description: Protocol Independent Multicast(3)
                      type: bool
                    trace:
                      description: Multicast trace(4)
                      type: bool
                    v1host-report:
                      description: IGMPv1 Membership Report(1)
                      type: bool
                    v2host-report:
                      description: IGMPv2 Membership Report(5)
                      type: bool
                    v2leave-group:
                      description: IGMPv2 Leave Group(6)
                      type: bool
                    v3host-report:
                      description: IGMPv3 Membership Report(9)
                      type: bool
                ip:
                  description: Any Internet Protocol
                  type: bool
                ipinip:
                  description: IP in IP tunneling
                  type: bool
                nos:
                  description: KA9Q NOS compatible IP over IP tunneling
                  type: bool
                ospf:
                  description: OSPF routing protocol
                  type: bool
                pcp:
                  description: Payload Compression Protocol
                  type: bool
                pim:
                  description: Protocol Independent Multicast
                  type: bool
                sctp:
                  description: Stream Control Transmission Protocol
                  type: bool
                tcp:
                  description: Transmission Control Protocol
                  type: dict
                  suboptions:
                    bgp:
                      description: Border Gateway Protocol (179)
                      type: bool
                    chargen:
                      description: Character generator (19)
                      type: bool
                    cmd:
                      description: Remote commands (rcmd, 514)
                      type: bool
                    daytime
                      description: Daytime (13)
                      type: bool
                    discard:
                      description: Discard (9)
                      type: bool
                    domain:
                      description: Domain Name Service (53)
                      type: bool
                    drip:
                      description: Dynamic Routing Information Protocol (3949)
                      type: bool
                    echo:
                      description: Echo (7)
                      type: bool
                    exec:
                      description: Exec (rsh, 512)
                      type: bool
                    finge:
                      description: Finger (79)
                      type: bool
                    ftp:
                      description: File Transfer Protocol (21)
                      type: bool
                    ftp-data:
                      description: FTP data connections (20)
                      type: bool
                    gopher:
                      description: Gopher (70)
                      type: bool
                    hostname:
                      description: NIC hostname server (101)
                      type: bool
                    ident:
                      description: Ident Protocol (113)
                      type: bool
                    irc:
                      description: Internet Relay Chat (194)
                      type: bool
                    klogin:
                      description: Kerberos login (543)
                      type: bool
                    kshell:
                      description: Kerberos shell (544)
                      type: bool
                    login:
                      description: Login (rlogin, 513)
                      type: bool
                    lpd:
                      description: Printer service (515)
                      type: bool
                    nntp:
                      description: Network News Transport Protocol (119)
                      type: bool
                    onep-plain
                      description: ONEP Cleartext (15001)
                      type: bool
                    onep-tls:
                      description: ONEP TLS (15002)
                      type: bool
                    pim-auto-rp:
                      description: PIM Auto-RP (496)
                      type: bool
                    pop2:
                      description: Post Office Protocol v2 (109)
                      type: bool
                    pop3:
                      description: Post Office Protocol v3 (110)
                      type: bool
                    smtp:
                      description: Simple Mail Transport Protocol (25)
                      type: bool
                    sunrpc:
                      description: Sun Remote Procedure Call (111)
                      type: bool
                    tacacs:
                      description: TAC Access Control System (49)
                      type: bool
                    talk:
                      description: Talk (517)
                      type: bool
                    telnet:
                      description: Telnet (23)
                      type: bool
                    time:
                      description: Time (37)
                      type: bool
                    uucp:
                      description: Unix-to-Unix Copy Program (540)
                      type: bool
                    whois:
                      description: Nicname (43)
                      type: bool
                    www:
                      description: World Wide Web (HTTP, 80)
                      type: bool
                udp:
                  description: User Datagram Protocol
                  type: dict
                  suboptions:
                    biff:
                      description: Biff (mail notification, comsat, 512)
                      type: bool
                    bootpc:
                      description: Bootstrap Protocol (BOOTP) client (68)
                      type: bool
                    bootps:
                      description: Bootstrap Protocol (BOOTP) server (67)
                      type: bool
                    discard:
                      description: Discard (9)
                      type: bool
                    dnsix:
                      description: DNSIX security protocol auditing (195)
                      type: bool
                    domain:
                      description: Domain Name Service (DNS, 53)
                      type: bool
                    echo:
                      description: Echo (7)
                      type: bool
                    isakmp:
                      description: Internet Security Association and Key Management Protocol (500)
                      type: bool
                    mobile-ip:
                      description: Mobile IP registration (434)
                      type: bool
                    nameserver:
                      description: IEN116 name service (obsolete, 42)
                      type: bool
                    netbios-dgm:
                      description: NetBios datagram service (138)
                      type: bool
                    netbios-ns:
                      description: NetBios name service (137)
                      type: bool
                    netbios-ss:
                      description: NetBios session service (139)
                      type: bool
                    non500-isakmp
                      description: Internet Security Association and Key Management Protocol (4500)
                      type: bool
                    ntp:
                      description: Network Time Protocol (123)
                      type: bool
                    pim-auto-rp:
                      description: PIM Auto-RP (496)
                      type: bool
                    rip:
                      description: Routing Information Protocol (router, in.routed, 520)
                      type: bool
                    snmp:
                      description: Simple Network Management Protocol (161)
                      type: bool
                    snmptrap:
                      description: SNMP Traps (162)
                      type: bool
                    sunrpc:
                      description: Sun Remote Procedure Call (111)
                      type: bool
                    syslog:
                      description: System Logger (514)
                      type: bool
                    tacacs:
                      description: TAC Access Control System (49)
                      type: bool
                    talk:
                      description: Talk (517)
                      type: bool
                    tftp:
                      description: Trivial File Transfer Protocol (69)
                      type: bool
                    time:
                      description: Time (37)
                      type: bool
                    who:
                      description: Who service (rwho, 513)
                      type: bool
                    xdmcp:
                      description: X Display Manager Control Protocol (177)
                      type: bool
    state:
      description:
      - The state the configuration should be left in
      type: str
      choices:
      - merged
      - replaced
      - overridden
      - deleted
      default: merged
EXAMPLES:
  - deleted_example_01.txt
  - merged_example_01.txt
  - replaced_example_01.txt
  - overridden_example_01.txt

